import streamlit as st

st.set_page_config(page_title="ãƒ™ã‚¸ã‚¿ã‚¤ãƒ—16è¨ºæ–­ã€€2nd", page_icon="ğŸ¥¦")

st.title("ãƒ™ã‚¸ã‚¿ã‚¤ãƒ—16è¨ºæ–­ 2ndï¼ˆ12å•ç‰ˆï¼‰")

# =========================
# 12å•ã®è³ªå•
# =========================
questions = [
    {"q": "1æ—¥3é£Ÿé£Ÿã¹ã¦ã„ã¾ã™ã‹ï¼Ÿ", "options": ["æ¯æ—¥ï¼“é£Ÿ", "ï¼’é£Ÿä»¥ä¸‹ã«ãªã‚‹ã“ã¨ãŒå¤šã„"]},
    {"q": "é£Ÿäº‹ã®æ™‚é–“ã¯ä¸€å®šã§ã™ã‹ï¼Ÿ", "options": ["Yes", "No"]},
    {"q": "æœé£Ÿã‚’é€±ã«ã©ã®ãã‚‰ã„é£Ÿã¹ã¾ã™ã‹ï¼Ÿ", "options": ["æ¯æ—¥", "é€±æ•°å›", "ã»ã¨ã‚“ã©é£Ÿã¹ãªã„"]},
    {"q": "ã©ã“ã§é£Ÿã¹ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã‹ï¼Ÿ", "options": ["å®¶", "å¤–é£Ÿ"]},
    {"q": "å¤–é£Ÿã®ã¨ãé‡èœã‚’é¸ã³ã¾ã™ã‹ï¼Ÿ", "options": ["Yes", "No"]},
    {"q": "å¤–é£Ÿã®é »åº¦ã¯ï¼Ÿ", "options": ["é€±0å›", "é€±1ã€œ2å›", "é€±3å›ä»¥ä¸Š"]},
    {"q": "é‡èœã‚’é£Ÿã¹ã‚‹ã®ã«éšœå£ã‚’æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ", "options": ["Yes", "No"]},  # Yes=0ã«ã—ãŸã„
    {"q": "é‡èœã®ä¾¡æ ¼ãŒé«˜ã„ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ", "options": ["Yes", "No"]},      # Yes=0ã«ã—ãŸã„
    {"q": "é‡èœã®èª¿ç†ã¯é¢å€’ã ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ", "options": ["Yes", "No"]},
    {"q": "é‡èœã‚’æ„è­˜ã—ã¦é£Ÿã¹ã¦ã„ã¾ã™ã‹ï¼Ÿ", "options": ["Yes", "No"]},
    {"q": "é‡èœã¯å¥åº·ã«å¿…è¦ã ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ", "options": ["Yes", "No"]},
    {"q": "é‡èœã¯å¥½ãã§ã™ã‹ï¼Ÿ", "options": ["Like", "Dislike"]},
]

# =========================
# å›ç­”å—ä»˜
# =========================
user_answers = []

for i, q in enumerate(questions):
    answer = st.radio(q["q"], q["options"], key=i)
    user_answers.append(answer)

# =========================
# è¨ºæ–­ãƒœã‚¿ãƒ³
# =========================
if st.button("è¨ºæ–­ã™ã‚‹ï¼"):
    # å›ç­”ã‚’æ•°å€¤ã«å¤‰æ›
    answer_map = {
        "æ¯æ—¥ï¼“é£Ÿ": 1, "ï¼’é£Ÿä»¥ä¸‹ã«ãªã‚‹ã“ã¨ãŒå¤šã„": 0,
        "Yes": 1, "No": 0,
        "æ¯æ—¥": 1, "é€±æ•°å›": 0.5, "ã»ã¨ã‚“ã©é£Ÿã¹ãªã„": 0,
        "å®¶": 1, "å¤–é£Ÿ": 0,
        "é€±0å›": 1, "é€±1ã€œ2å›": 0.5, "é€±3å›ä»¥ä¸Š": 0,
        "Like": 1, "Dislike": 0,
    }

    user_vector = []
    for i, a in enumerate(user_answers):
        if i == 6 or i == 7:  # éšœå£ãƒ»ä¾¡æ ¼ã®è³ªå•
            if a == "Yes":
                user_vector.append(0)
            else:
                user_vector.append(1)
        else:
            user_vector.append(answer_map[a])

    # =========================
    # 16ã‚¿ã‚¤ãƒ—ã®ç†æƒ³ãƒ™ã‚¯ãƒˆãƒ«
    # =========================
    types = [
        "RHFL", "RHFD", "RHBL", "RHBD",
        "REFL", "REFD", "REBL", "REBD",
        "IHFL", "IHFD", "IHBL", "IHBD",
        "IEFL", "IEFD", "IEBL", "IEBD"
    ]

    ideal_vectors = [
        [1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,0,0,0],
        [1,1,1,1,1,1,0,0,0,1,1,1],
        [1,1,1,1,1,1,0,0,0,0,0,0],
        [1,1,1,0,0,0,1,1,1,1,1,1],
        [1,1,1,0,0,0,1,1,1,0,0,0],
        [1,1,1,0,0,0,0,0,0,1,1,1],
        [1,1,1,0,0,0,0,0,0,0,0,0],
        [0,0,0,1,1,1,1,1,1,1,1,1],
        [0,0,0,1,1,1,1,1,1,0,0,0],
        [0,0,0,1,1,1,0,0,0,1,1,1],
        [0,0,0,1,1,1,0,0,0,0,0,0],
        [0,0,0,0,0,0,1,1,1,1,1,1],
        [0,0,0,0,0,0,1,1,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,1,1,1],
        [0,0,0,0,0,0,0,0,0,0,0,0],
    ]

    # =========================
    # ä¸€è‡´ç‡è¨ˆç®—
    # =========================
    scores = []
    for ideal in ideal_vectors:
        match = 0
        for i in range(12):
            if abs(user_vector[i] - ideal[i]) == 0:
                match += 1
            elif user_vector[i] == 0.5 and (ideal[i] == 1 or ideal[i] == 0):
                match += 0.5
        percent = (match / 12) * 100
        scores.append(percent)

    # =========================
    # è¡¨ç¤º
    # =========================
    st.subheader("è¨ºæ–­çµæœ")
    for t, s in zip(types, scores):
        st.write(f"**{t}åº¦ï¼š{s:.1f}%**")

    max_idx = scores.index(max(scores))
    st.success(f"ã‚ãªãŸã®ä»£è¡¨ã‚¿ã‚¤ãƒ—ã¯ **{types[max_idx]}** ã§ã™ï¼")
    st.subheader(
    "ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã”å›ç­”ãŠé¡˜ã„ã—ã¾ã™ï¼ï¼š [ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ](https://docs.google.com/forms/d/e/1FAIpQLSfMbMGtTDsTk-f8VTxYseqijcZDyrIfZKyf9e-ryCThoHxVag/viewform)",
    unsafe_allow_html=True
)

