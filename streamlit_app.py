import streamlit as st

st.set_page_config(page_title="ãƒ™ã‚¸ã‚¿ã‚¤ãƒ—16è¨ºæ–­", page_icon="ğŸ¥¦")

st.title("ãƒ™ã‚¸ã‚¿ã‚¤ãƒ—16è¨ºæ–­ï¼ˆ12å•ç‰ˆï¼‰")

# =========================
# 12å•ã®è³ªå•
# =========================
questions = [
    {"q": "1æ—¥3é£Ÿé£Ÿã¹ã¦ã„ã¾ã™ã‹ï¼Ÿ", "options": ["Regular", "Irregular"]},
    {"q": "é£Ÿäº‹ã®æ™‚é–“ã¯ä¸€å®šã§ã™ã‹ï¼Ÿ", "options": ["Yes", "No"]},
    {"q": "æœé£Ÿã‚’é€±ã«ã©ã®ãã‚‰ã„é£Ÿã¹ã¾ã™ã‹ï¼Ÿ", "options": ["æ¯æ—¥", "é€±æ•°å›", "ã»ã¨ã‚“ã©é£Ÿã¹ãªã„"]},
    {"q": "å®¶ã§é£Ÿã¹ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã‹ï¼Ÿ", "options": ["Home", "Eat out"]},
    {"q": "å¤–é£Ÿã®ã¨ãé‡èœã‚’é¸ã³ã¾ã™ã‹ï¼Ÿ", "options": ["Yes", "No"]},
    {"q": "å¤–é£Ÿã®é »åº¦ã¯ï¼Ÿ", "options": ["é€±0å›", "é€±1ã€œ2å›", "é€±3å›ä»¥ä¸Š"]},
    {"q": "é‡èœã‚’é£Ÿã¹ã‚‹ã®ã«éšœå£ã‚’æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ", "options": ["Free", "Barrier"]},
    {"q": "é‡èœã®ä¾¡æ ¼ãŒé«˜ã„ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ", "options": ["No", "Yes"]},
    {"q": "é‡èœã®èª¿ç†ã¯é¢å€’ã ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ", "options": ["No", "Yes"]},
    {"q": "é‡èœã‚’æ„è­˜ã—ã¦é£Ÿã¹ã¦ã„ã¾ã™ã‹ï¼Ÿ", "options": ["Yes", "No"]},
    {"q": "é‡èœã¯å¥åº·ã«å¿…è¦ã ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ", "options": ["Yes", "No"]},
    {"q": "é‡èœã¯å¥½ãã§ã™ã‹ï¼Ÿ", "options": ["Like", "Dislike"]},
]

# =========================
# å›ç­”å—ä»˜
# =========================
user_answers = []

for i, q in enumerate(questions):
    answer = st.radio(q["q"], q["options"], key=i)
    user_answers.append(answer)

# =========================
# è¨ºæ–­ãƒœã‚¿ãƒ³
# =========================
if st.button("è¨ºæ–­ã™ã‚‹ï¼"):
    # å›ç­”ã‚’æ•°å€¤ã«å¤‰æ›
    answer_map = {
        "Regular": 1, "Irregular": 0,
        "Yes": 1, "No": 0,
        "æ¯æ—¥": 1, "é€±æ•°å›": 0.5, "ã»ã¨ã‚“ã©é£Ÿã¹ãªã„": 0,
        "Home": 1, "Eat out": 0,
        "é€±0å›": 1, "é€±1ã€œ2å›": 0.5, "é€±3å›ä»¥ä¸Š": 0,
        "Free": 1, "Barrier": 0,
        "Like": 1, "Dislike": 0,
    }
    user_vector = [answer_map[a] for a in user_answers]

    # =========================
    # 16ã‚¿ã‚¤ãƒ—ã®ç†æƒ³ãƒ™ã‚¯ãƒˆãƒ«
    # =========================
    types = [
        "RHFL", "RHFD", "RHBL", "RHBD",
        "REFL", "REFD", "REBL", "REBD",
        "IHFL", "IHFD", "IHBL", "IHBD",
        "IEFL", "IEFD", "IEBL", "IEBD"
    ]

    ideal_vectors = [
        [1,1,1,1,1,1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1,1,1,0,0,0],
        [1,1,1,1,1,1,0,0,0,1,1,1],
        [1,1,1,1,1,1,0,0,0,0,0,0],
        [1,1,1,0,0,0,1,1,1,1,1,1],
        [1,1,1,0,0,0,1,1,1,0,0,0],
        [1,1,1,0,0,0,0,0,0,1,1,1],
        [1,1,1,0,0,0,0,0,0,0,0,0],
        [0,0,0,1,1,1,1,1,1,1,1,1],
        [0,0,0,1,1,1,1,1,1,0,0,0],
        [0,0,0,1,1,1,0,0,0,1,1,1],
        [0,0,0,1,1,1,0,0,0,0,0,0],
        [0,0,0,0,0,0,1,1,1,1,1,1],
        [0,0,0,0,0,0,1,1,1,0,0,0],
        [0,0,0,0,0,0,0,0,0,1,1,1],
        [0,0,0,0,0,0,0,0,0,0,0,0],
    ]

    # =========================
    # ä¸€è‡´ç‡è¨ˆç®—
    # =========================
    scores = []
    for ideal in ideal_vectors:
        # 12å•ä¸­ä¸€è‡´ã—ã¦ã„ã‚‹é …ç›®ã®å‰²åˆ
        match = 0
        for i in range(12):
            # é€±æ•°å›ã‚„é€±1ã€œ2å›ã¯0.5ãªã®ã§è¿‘ã„æ–¹ã«0.5ç‚¹
            if abs(user_vector[i] - ideal[i]) == 0:
                match += 1
            elif user_vector[i] == 0.5 and ideal[i] == 1:
                match += 0.5
            elif user_vector[i] == 0.5 and ideal[i] == 0:
                match += 0.5
        percent = (match/12)*100
        scores.append(percent)

    # =========================
    # è¡¨ç¤º
    # =========================
    st.subheader("è¨ºæ–­çµæœ")
    for t, s in zip(types, scores):
        st.write(f"**{t}åº¦ï¼š{s:.1f}%**")

    # ä»£è¡¨ã‚¿ã‚¤ãƒ—
    max_idx = scores.index(max(scores))
    st.success(f"ã‚ãªãŸã®ä»£è¡¨ã‚¿ã‚¤ãƒ—ã¯ **{types[max_idx]}** ã§ã™ï¼")

